# WindowsFormsSettingsManager

**WindowsFormsSettingsManager** — это библиотека для управления настройками в приложениях, предназначенная для использования в среде T-FLEX DOCs. Библиотека предоставляет функционал для работы с настройками через интерфейсы, сохранение данных в формате JSON и интеграцию с локальными и глобальными хранилищами данных.

## Описание

Этот класс используется для упрощения конфигурирования макросов и приложений, разрабатываемых в среде DOCs. Библиотека позволяет создавать, управлять, редактировать и сохранять настройки, поддерживая локальные и глобальные хранилища. Логика работы с настройками инкапсулирована в классе `SettingsManager`, который использует JSON сериализацию для хранения данных.

## Основные функции

- **Управление настройками**: хранение, редактирование, создание и удаление наборов настроек.
- **Поддержка локальных и глобальных настроек**: локальные настройки сохраняются в текстовых файлах, глобальные — в хранилище DOCs.
- **Редактирование JSON строк**: пользователь может редактировать настройки через текстовое поле в диалоге, с валидацией JSON строки.
- **Графический интерфейс**: возможность выбора активной настройки и просмотра метаданных (даты создания, автор и т. д.).
- **Множественные экземпляры настроек**: поддержка нескольких экземпляров настроек с возможностью выбора активного.

## Структура проекта

Проект состоит из нескольких классов и интерфейсов:

- **SettingsManager** — основной класс для управления настройками.
- **ISettingsManager** — интерфейс для взаимодействия с менеджером настроек.
- **Settings** — класс, который содержит настройки.
- **ISettingsContainer** — интерфейс для контейнера с настройками.
- **SettingsForm** — форма для редактирования и управления настройками.
- **TempTextFileInfo**, **GlobalParameterInfo** — классы для работы с временными и глобальными хранилищами настроек.

### Параметр SettingsScope

**SettingsScope** — это перечисление, которое указывает, какой тип хранилища будет использоваться для настройки:

- **OnlyLocal**: настройки будут сохраняться и загружаться только из локального хранилища.
  
- **OnlyGlobal**: настройки будут сохраняться и загружаться только из глобального хранилища. 
  
- **LocalAndGlobal**: настройки будут сначала загружаться из локального хранилища (если они существуют). Если локальные настройки отсутствуют, будет использовано глобальное хранилище.

### Примеры использования класса


### 1. Инициализация и использование `SettingsManager`

```csharp
// Создание класса настроек
public class TestSettings : ISettings
{
    public int Integer { get; set; } 
    public string String { get; set; } 
    public double Double { get; set; }
    public bool Bool { get; set; }
    public List<string> ListValues { get; set; }
    
    public void SetDefaultValues()
    {
        Integer = 1;
        String = "TestString";
        Double = 0.5;
        Bool = true;
        ListValues = new List<string>() { "один", "два", "три" };
    }
}

SettingsScope scope = SettingsScope.OnlyGlobal; 

// Инициализация менеджера настроек
SettingsManager<TestSettings> manager = new SettingsManager<TestSettings>("Барциц", "Тестовые настройки (Аким)", Context.Connection, scope);

// Получение и вывод активных настроек
var activeSettings = settingsManager.Active.Value();
MessageBox.Show(activeSettings.JsonString);
```

### 2. Вызов диалога редактирования настроек
```csharp
// Вызов будет происходить из публичного метода макроса, который можно будет повесить на кнопку в DOCs
public SettingsManager SettingsManager { get; set; }
public Macro(MacroContext context) : MacroProvider(context) {
    /*
    Инициализация менеджера, в подробностях показана в примере выше
    */
}

public void ChangeSettings() {
    this.SettingsManager.ShowDialog();
};
```